\chapter{RESULTADOS E DISCUSSÃO}

Os conhecimentos adquiridos ao longo desse trabalho permitiram a criação de um arcabouço capaz de gerar terrenos procedurais e também de levar em consideração algumas entradas do usuário. Na Seção \ref{arcabouco} será apresentado tal arcabouço. Na Seção \ref{grafocena} será mostrado o grafo de cena implementado e, finalmente, na Seção \ref{terrenosgerados} alguns exemplos de terrenos gerados proceduralmente com o arcabouço.



\section{Arcabouço}
\label{arcabouco}

O arcabouço implementado aqui teve como um dos principais objetivos a possibilidade de futuras expansões. A Figura \ref{fig:node} mostra as classes já implementadas, como \emph{PerlinNoise} e \emph{Plasma} (para geração procedural através dos algoritmos de ruído de Perlin e Plasma), e também a \emph{FileHeightmap}, que é a responsável por ler mapas de altura de arquivos de imagem. Quaisquer novos algoritmos de geração procedural de terrenos devem ser filhos da classe \emph{Terrain}, que já encapsula uma série de funções pertinentes à visualização de terrenos.


\begin{figure}[H]
	\center{\includegraphics[width=0.5\linewidth]{img/node.png}}
	\caption{\label{fig:node} Classes representando os nodos.}
\end{figure}

A câmera implementada no arcabouço permite que o usuário navegue pelo terreno com o controle do mouse e do teclado.

\section{Grafo de cena implementado}
\label{grafocena}

Para a visualização dos terrenos, foi criada uma estrutura de grafo de cena. Na estrutura, cada nodo representa um terreno gerado. A Figura \ref{fig:grafo2} considera que a câmera está situada acima do \emph{Terreno 0}, e assim ele possui oito nodos filhos ao seu redor.

\begin{figure}[H]
	\center{\includegraphics[width=0.25\linewidth]{img/grafo_cena2.png}}
	\caption{\label{fig:grafo2} Grafo de cena e terrenos, com a câmera no Terreno 0.}
\end{figure}

Na Figura \ref{fig:grafo3}, a câmera passa a estar em cima do Terreno 5. Logo, serão gerados os terrenos 8, 9 e 10. Os terrenos 1, 4 e 6 (em branco) poderão ser excluídos, enquanto que os terrenos 0, 2, 3, 7 e 8 passarão a apontar para um novo nodo pai: o nodo que representa o terreno 5.

\begin{figure}[H]
	\center{\includegraphics[width=0.25\linewidth]{img/grafo_cena3.png}}
	\caption{\label{fig:grafo3} Grafo de cena e terrenos, com a câmera no Terreno 5.}
\end{figure}

Outro aspecto levado em consideração, foi o número de terrenos gerados e o número de terrenos que estão sendo visualizados. Na Figura \ref{fig:grafo1}, os terrenos em branco foram gerados, mas não serão renderizados na tela, para economizar recursos da placa de vídeo. O número e as distâncias entre os terrenos gerados e visualizados são parâmetros do arcabouço.

\begin{figure}[H]
	\center{\includegraphics[width=0.45\linewidth]{img/grafo_cena1.png}}
	\caption{\label{fig:grafo1} Visualização e geração dos terrenos.}
\end{figure}


\section{Terrenos gerados}
\label{terrenosgerados}

As Figuras \ref{fig:tela2} e \ref{fig:tela3}, e \ref{fig:tela6} e \ref{fig:tela7} mostram os terrenos gerados variando o número de iterações do ruído de Perlin e o número de terrenos vizinhos exibidos.

\begin{figure}[H]
	\center{\includegraphics[width=0.85\linewidth]{img/caps/2.png}}
	\caption{\label{fig:tela2} Tela com o terreno gerado (exibição em \emph{wireframes}).}
\end{figure}

\begin{figure}[H]
	\center{\includegraphics[width=0.85\linewidth]{img/caps/3.png}}
	\caption{\label{fig:tela3} Tela com o terreno gerado.}
\end{figure}

\begin{figure}[H]
	\center{\includegraphics[width=0.85\linewidth]{img/caps/6.png}}
	\caption{\label{fig:tela6} Tela com o terreno gerado (exibição em \emph{wireframes}).}
\end{figure}

\begin{figure}[H]
	\center{\includegraphics[width=0.85\linewidth]{img/caps/7.png}}
	\caption{\label{fig:tela7} Tela com o terreno gerado.}
\end{figure}

As Figuras \ref{fig:tela4} e \ref{fig:tela5} mostram um terreno gerado proceduralmente e o mapa de altura exibido na Figura \ref{fig:mapaaltura} inserido no arcabouço (mostrado no arcabouço em um tom cinza mais escuro).

\begin{figure}[H]
	\center{\includegraphics[width=0.25\linewidth]{img/heightmap.png}}
	\caption{\label{fig:mapaaltura} Mapa de altura inserido pelo usuário.}
\end{figure}

\begin{figure}[H]
	\center{\includegraphics[width=0.85\linewidth]{img/caps/4.png}}
	\caption{\label{fig:tela4} Tela com o terreno gerado e um mapa de altura inserido.}
\end{figure}

\begin{figure}[H]
	\center{\includegraphics[width=0.85\linewidth]{img/caps/5.png}}
	\caption{\label{fig:tela5} Tela com o terreno gerado e um mapa de altura inserido (exibição em \emph{wireframes}).}
\end{figure}

\newpage
As Figuras \ref{fig:tela8} e \ref{fig:tela9} mostram os terrenos com uma \emph{interface} provisória, onde é possível escolher os parâmetros dos terrenos a serem gerados.

\begin{figure}[H]
	\center{\includegraphics[width=0.8\linewidth]{img/caps/8.png}}
	\caption{\label{fig:tela8} Tela com a \emph{interface} do usuário (exibição em \emph{wireframes}).}
\end{figure}

\begin{figure}[H]
	\center{\includegraphics[width=0.8\linewidth]{img/caps/9.png}}
	\caption{\label{fig:tela9} Tela com a \emph{interface} do usuário.}
\end{figure}

\section{Testes}
Alguns testes foram feitos, para avaliar a variação de frames por segundo (\sigla{FPS}{Frames por segundo}) com a alteração de alguns parâmetros. Eles foram executados em um \emph{Athlon64 3500}, com 2GB de memória \emph{RAM} e placa de vídeo GeForce6600 com 64MB de memória.

A Seção \ref{teste_geracao} mostra um teste com a geração de 100 terrenos proceduralmente.

As Seções \ref{teste_variando_octaves} e \ref{teste_variando_vizinhos} apresentam testes que consistiam em um vôo da câmera pelo terreno durante 60 segundos, em um trajeto constante para todos os testes.

\subsection{Teste 1}
\label{teste_geracao}
\input{teste_geracao}

\subsection{Teste 2}
\label{teste_variando_octaves}
\input{teste_variando_octaves}


\subsection{Teste 3}
\label{teste_variando_vizinhos}
\input{teste_variando_vizinhos}

